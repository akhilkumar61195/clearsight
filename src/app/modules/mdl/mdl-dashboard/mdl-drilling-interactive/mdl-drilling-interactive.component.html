<!-- Full Page Layout (Conditionally render if isPageView is true) -->
<div style="width: 100%;height:100%;" class="mt-1 relativePosition">

    <div class="grid bg-theme-blue filtercontrols filtersection blue-background">
        <div class="col-12 sm:col-12 md:col-6 lg:col-3 p-6px">
            <span class="p-input-icon-left inputsearchSpan">
                <i class="pi pi-search"></i>
                <input #searchComponent pInputText type="text" [(ngModel)]="searchComponents" class="whiteblue"
                    [disabled]="isEdit" (input)="onSearch($event)" placeholder="Search" />
            </span>
        </div>
        <div class="col-0 sm:col-0 md:col-10 lg:col-9 p-6px">
            <p-button type="text" styleClass="chv-light-blue-btn" label="Reset" (click)="reset(searchComponent)"
                class="ml-2"></p-button>
            <p-button type="text" styleClass="chv-light-blue-btn" label="Add Record" (click)="addNewRecord()"
                class=" ml-2" icon="pi pi-plus-circle"></p-button>
            <p-button type="text" styleClass="chv-light-blue-btn" label="List Editor"
                (click)="drillingListEditor.isListEditorVisible = true" class=" ml-2" icon="pi pi-pencil"></p-button>   
        </div>
    </div>
    <div class="ag-grid-container">
        <ag-grid-angular [ngStyle]="{ height: height$ | async }" class="ag-theme-alpine"
            [columnDefs]="materialColumnDefs" [rowData]="materialRecords" [rowHeight]="rowHeight"
            [defaultColDef]="{ flex: 1,autoHeight:true, resizable: true, sortable: true, filter: true, minWidth: 90, suppressHeaderMenuButton: true }"
            [animateRows]="true" [loading]="loading" (gridReady)="onGridReady($event)"
            (rowClicked)="OpenEditDialog($event.data);" [rowSelection]="rowSelection" [rowDragManaged]="true"
            [gridOptions]="gridOptions" [quickFilterText]="quickFilterText"
            (cellValueChanged)="onCellValueChanged($event)" (selectionChanged)="onSelectionChanged($event)"
            (rowDragEnd)="onRowDragEnd($event)" [sideBar]="sideBar">
        </ag-grid-angular>
        <div class="pagination-block">
            <div>
                <span class="labeltxt">Total Records:</span> {{totalRecords ? totalRecords : 0}}
            </div>
            <div>
                <p-button label="Cancel" (click)="resetGrid()" [outlined]="true" [disabled]="!isEdit"></p-button>
                <p-button label="Save" (click)="onSave()" class="ml-2" [disabled]="!isEdit"></p-button>
            </div>
        </div>
    </div>
</div>

<p-dialog [(visible)]="displayEquipmentDialog" [modal]="true" [closable]="false" [style]="{width: '45%'}">
    <ng-template pTemplate="header">
        <div class="dialog-header" style="z-index: 9999;">
            <h3 class="dialog-heading">Add Material</h3>
            <button class="dialog-header-close-btn" pButton icon="pi pi-times" (click)="closeDialog()"></button>
        </div>
    </ng-template>
    <ng-template pTemplate="body">
        <form [formGroup]="addEquipmentForm" (ngSubmit)="addNewMaterial()">
            <div class="p-fluid grid pl-2 pr-2 well-details pt-0 pb-0">
                <div class="form-group well-group col-6">
                    <label class="well-label w-93" for="holeSection">Hole Selection<span class="required">*</span>
                    </label>

                    <p-dropdown [options]="holeSelectionList" [filter]="true" class="mt-2 db"
                        formControlName="holeSection">
                    </p-dropdown>
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label w-93" for="hsType">HS Type<span class="required">*</span></label>
                    <p-dropdown [options]="hsTypeList" [filter]="true" class="mt-2 db" formControlName="hsType">
                    </p-dropdown>
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label w-93" for="group">Material Group<span class="">&nbsp;</span></label>
                    <p-dropdown [options]="groupList" [filter]="true" class="mt-2 db" formControlName="mGroup">
                    </p-dropdown>
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label w-93" for="materialType">Material Type<span
                            class="required">*</span></label>
                    <p-dropdown [options]="materialTypeList" [filter]="true" class="mt-2 db"
                        formControlName="materialType">
                    </p-dropdown>
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label w-93" for="UnitOfMeasurement">Unit Of Measurement</label>
                    <p-dropdown [options]="uomList" [filter]="true" class="mt-2 db" formControlName="uoMid"
                        optionLabel="value" optionValue="id" placeholder="Select UoM">
                    </p-dropdown>
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="VendorSapnumber">Vendor SAP #</label>
                    <input type="text" id="VendorSapnumber" pInputText formControlName="vendorSapnumber"
                        class="mt-2 db" />
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="materialShortDesc">Item Short description<span
                            class="required">*</span></label>
                    <input pInputText type="text" formControlName="materialShortDesc" class="mt-2 db" />

                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="marketUnitPrice">Market Unit Price<span
                            class="">&nbsp;</span></label>
                    <input pInputText type="number" formControlName="marketUnitPrice" class="mt-2 db" />
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="materialId">MM<span class="required">*</span></label>
                    <input pInputText type="text" formControlName="materialId" class="mt-2 db" />
                </div>

                <div class="form-group well-group col-6">
                    <label class="well-label" for="wall">Wall<span class="">&nbsp;</span></label>
                    <input pInputText type="number" formControlName="wall" class="mt-2 db" />
                </div>

                <div class="form-group well-group col-6">
                    <label class="well-label" for="od">OD<span class="">&nbsp;</span></label>

                    <input pInputText type="number" formControlName="od" class="mt-2 db" />

                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="weight">Weight<span class="">&nbsp;</span></label>
                    <input pInputText type="number" formControlName="weight" class="mt-2 db" />
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="grade">Grade<span class="">&nbsp;</span> </label>
                    <input pInputText type="text" formControlName="grade" class="mt-2 db" />

                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="connection">Connection<span class="">&nbsp;</span> </label>
                    <input pInputText type="text" formControlName="connection" class="mt-2 db" />

                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label w-93" for="vendor">Vendor<span class="">&nbsp;</span></label>
                    <p-dropdown [options]="vendorList" [filter]="true" class="mt-2 db" formControlName="vendor">
                    </p-dropdown>
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="manfacturer">Manufacturer<span class="required">*</span></label>
                    <input pInputText type="text" formControlName="manufacturerNum" class="mt-2 db" />
                </div>

                <div class="form-group well-group col-6">
                    <label class="well-label" for="tier">Tier<span class="">&nbsp;</span></label>
                    <input pInputText type="text" formControlName="tier" class="mt-2 db" />
                </div>
                <div class="form-group well-group col-6">
                    <label class="well-label" for="sourservice" style="width: 48%;">Sour Service<span
                            class="">&nbsp;</span></label>
                    <div class="mt-2">
                        <p-checkbox formControlName="sourservice" binary="true" [label]="''" [trueValue]="'Yes'"
                            [falseValue]="'No'">
                        </p-checkbox>
                    </div>
                </div>
            </div>

            <div class="form-group footer-buttons-container">
                <button pButton style="align-self:center" label="Save" [disabled]="!addEquipmentForm.valid"
                    class="p-button-primary"></button>
            </div>
        </form>
    </ng-template>
</p-dialog>

<app-list-editor #drillingListEditor></app-list-editor>